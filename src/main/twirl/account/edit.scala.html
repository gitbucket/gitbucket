@(account: Option[model.Account], info: Option[Any], error: Option[Any])(implicit context: app.Context)
@import context._
@import view.helpers._
@html.main(if(account.isDefined) "Edit your profile" else "Create your account"){
  @if(account.isDefined){
    <h3>Edit your profile</h3>
  } else {
    <h3>Create your account</h3>
  }
  @helper.html.information(info)
  @helper.html.error(error)
  <form action="@if(account.isDefined){@url(account.get.userName)/_edit}else{@path/register}" method="POST" validate="true">
    <div class="row-fluid">
      <div class="span6">
        @if(account.isEmpty){
          <fieldset>
            <label for="userName" class="strong">Username:</label>
            <input type="text" name="userName" id="userName" value=""/>
            <span id="error-userName" class="error"></span>
          </fieldset>
        }
        @if(account.map(_.password.nonEmpty).getOrElse(true)){
          <fieldset>
            <label for="password" class="strong">
              @if(account.nonEmpty){
                Old password (input to change password):
              } else {
                Password:
              }
            </label>
            <input type="password" name="password" id="password" value=""/>
            <span id="error-password" class="error"></span>
          </fieldset>
          @if(account.nonEmpty){
            <fieldset>
              <label for="newPassword" class="strong">
                New password:
              </label>
              <input type="password" name="newPassword" id="newPassword" value=""/>
              <span id="error-newPassword" class="error"></span>
            </fieldset>
            <fieldset>
              <label for="newPasswordRepeated" class="strong">
                Repeat new password:
              </label>
              <input type="password" name="newPasswordRepeated" id="newPasswordRepeated" value=""/>
              <span id="error-newPasswordRepeated" class="error"></span>
            </fieldset>
          }
        }
        <fieldset>
          <label for="fullName" class="strong">Full Name:</label>
          <input type="text" name="fullName" id="fullName" value="@account.map(_.fullName)"/>
          <span id="error-fullName" class="error"></span>
        </fieldset>
        <fieldset>
          <label for="mailAddress" class="strong">Mail Address:</label>
          <input type="text" name="mailAddress" id="mailAddress" value="@account.map(_.mailAddress)"/>
          <span id="error-mailAddress" class="error"></span>
        </fieldset>
        <fieldset>
          <label for="url" class="strong">URL (optional):</label>
          <input type="text" name="url" id="url" style="width: 400px;" value="@account.map(_.url)"/>
          <span id="error-url" class="error"></span>
        </fieldset>
      </div>
      <div class="span6">
        <fieldset>
          <label for="avatar" class="strong">Image (optional):</label>
          @helper.html.uploadavatar(account)
        </fieldset>
      </div>
    </div>
    <fieldset class="margin">
      @if(account.isDefined){
        <div class="pull-right">
          <a href="@path/@account.get.userName/_delete" class="btn btn-danger" id="delete">Delete account</a>
        </div>
        <input type="submit" class="btn btn-success" value="Save"/>
        <a href="@url(account.get.userName)" class="btn">Cancel</a>
      } else {
        <input type="submit" class="btn btn-success" value="Create account"/>
      }
    </fieldset>
  </form>
}
<script>
$(function(){
  $('#delete').click(function(){
    return confirm('Once you delete your account, there is no going back.\nAre you sure?');
  });
});
</script>
