@(files: List[gitbucket.core.service.RepositorySearchService.FileSearchResult],
  query: String,
  page: Int,
  repository: gitbucket.core.service.RepositoryService.RepositoryInfo)(implicit context: gitbucket.core.controller.Context)
@import gitbucket.core.view.helpers
@import gitbucket.core.service.RepositorySearchService
@gitbucket.core.html.main("Search Results", Some(repository)){
  @gitbucket.core.search.html.menu("files", query, repository){
    @if(query.nonEmpty) {
      @if(files.isEmpty) {
        <h6>We couldn't find any code matching '@query'</h6>
      } else {
        <h6>We have found @files.size code @helpers.plural(files.size, "result")</h6>
      }
    }
    @files.drop((page - 1) * RepositorySearchService.CodeLimit).take(RepositorySearchService.CodeLimit).map { file =>
      <div>
        <h5><a href="@helpers.url(repository)/blob/@repository.repository.defaultBranch/@file.path">@file.path</a></h5>
        <div class="small text-muted">Last committed @gitbucket.core.helper.html.datetimeago(file.lastModified)</div>
        <div class="p-1">
          <pre class="bg-light p-0 prettyprint linenums:@file.highlightLineNumber">@Html(file.highlightText)</pre>
        </div>
      </div>
    }
    @gitbucket.core.helper.html.paginator(page, files.size, RepositorySearchService.CodeLimit, 10,
      s"${helpers.url(repository)}/search?q=${helpers.urlEncode(query)}&type=code")
  }
}
