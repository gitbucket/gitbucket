@(pathList: List[String],
  branch: String,
  repository: gitbucket.core.service.RepositoryService.RepositoryInfo,
  commits: Seq[Seq[(gitbucket.core.util.JGitUtil.CommitInfo, List[String], Option[(gitbucket.core.model.CommitState, List[gitbucket.core.model.CommitStatus])])]],
  page: Int,
  hasNext: Boolean,
  hasWritePermission: Boolean)(implicit context: gitbucket.core.controller.Context)
@import gitbucket.core.view.helpers
@gitbucket.core.html.main(s"${repository.owner}/${repository.name}", Some(repository)) {
  @gitbucket.core.html.menu("files", repository){

<div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <div class="head">
            @if(pathList.isEmpty){
              @gitbucket.core.helper.html.branchcontrol(branch, repository, hasWritePermission){
                @repository.branchList.map { x =>
                  <a class="dropdown-item" href="@helpers.url(repository)/commits/@helpers.encodeRefName(x)">@gitbucket.core.helper.html.checkicon(x == branch) @x</a>
                }
              }
            }
            @if(pathList.nonEmpty){
              <span class="text-muted">History for</span>
              <a class="font-weight-bold strong" href="@helpers.url(repository)/tree/@helpers.encodeRefName(branch)">@repository.name</a> /
              @pathList.zipWithIndex.map { case (section, i) =>
                @if(i == pathList.length - 1){
                  <span class="font-weight-bold strong">@section</span>
                } else {
                  <a class="font-weight-bold strong" href="@helpers.url(repository)/tree/@helpers.encodeRefName((branch :: pathList.take(i + 1)).mkString("/"))">@section</a> /
                }
              }
            }
          </div>
        </div><!-- /.card-header -->
        <div class="card-body">
          <table class="table table-bordered table-hover">
            @commits.map { day =>
            <tr>
              <th rowspan="@day.size" width="150">@helpers.date(day.head._1.commitTime)</th>
              @day.zipWithIndex.map { case ((commit, tags, status), i) =>
              @if(i != 0){ <tr> }
            <td>
              <div class="row">
                <div class="col-md-auto commit-avatar-image">
                  @helpers.avatarLink(commit, 40)
                </div><!-- /.col -->
                <div class="col-md">
                  <span class="font-weight-bold">@helpers.link(commit.summary, repository)</span>
                  @if(commit.description.isDefined){
                  <a href="javascript:void(0)" onclick="$('#description-@commit.id').toggle();" class="omit">...</a>
                  }
                  <br>
                  @if(commit.description.isDefined){
                  <pre id="description-@commit.id" style="display: none;" class="commit-description">@helpers.link(commit.description.get, repository)</pre>
                  }
                  <div>
                    @if(commit.isDifferentFromAuthor) {
                    @helpers.user(commit.authorName, commit.authorEmailAddress, "username")
                    <span class="text-muted">authored @gitbucket.core.helper.html.datetimeago(commit.authorTime)</span>
                    <span class="octicon octicon-arrow-right" style="margin-top : -2px;"></span>
                    }
                    @helpers.user(commit.committerName, commit.committerEmailAddress, "username")
                    <span class="text-muted">committed @gitbucket.core.helper.html.datetimeago(commit.commitTime)</span>
                    @status.map { case (summary, statuses) =>
                    @gitbucket.core.helper.html.commitstatus(commit.id, summary, statuses)
                    }
                  </div>
                </div><!-- /.col -->
                <div class="col-md-auto text-right">
                  @if(commit.commitSign.isDefined){
                  @commit.verified.map{ v =>
                  <span class="gpg-verified" data-toggle="tooltip" title="Signed by @v.signedUser (@v.signedKeyId)">Verified</span>
                  }.getOrElse{
                  <span class="gpg-unverified">Unverified</span>
                  }
                  }
                  @if(tags.nonEmpty){
                  <span class="text-muted">
                    <i class="octicon octicon-tag"></i>
                    @tags.map { tag =>
                      <a href="@helpers.url(repository)/tree/@tag" class="tag">@tag</a>
                    }
                  </span>
                  }
                  <a href="@helpers.url(repository)/commit/@commit.id" class="monospace commit-message font-weight-bold strong"><i class="octicon octicon-diff" style="color: black;"></i>@commit.id.substring(0, 7)</a><br>
                  <a href="@helpers.url(repository)/tree/@commit.id" class="button-link">Browse files Â»</a>
                </div><!-- /.col -->
              </div><!-- /.row -->
            </td>
          </tr>
            }
            }
          </table>

          <nav class="mt-4">
            <ul class="pagination">
              @if(page <= 1){
              <li class="disabled page-item"><span class="page-link">Newer</span></li>
              } else {
              <li class="page-item"><a class="page-link" href="?page=@{page - 1}">Newer</a></li>
              }
              @if(!hasNext){
              <li class="disabled page-item"><span class="page-link">Older</span></li>
              } else {
              <li class="page-item"><a class="page-link" href="?page=@{page + 1}">Older</a></li>
              }
            </ul>
          </nav>
        </div><!-- /.card-body -->
      </div><!-- /.card -->
    </div><!-- /.col -->
  </div><!-- /.row -->
</div><!-- /.container -->
<script>
  $(function() {
    $('[data-toggle="tooltip"]').tooltip();
  });
</script>
<style type="text/css">
  a.tag {
    color: #888888;
    margin-right: 4px;
  }
</style>
  }
}
