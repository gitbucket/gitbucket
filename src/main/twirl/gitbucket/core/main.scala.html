@(title: String, repository: Option[gitbucket.core.service.RepositoryService.RepositoryInfo] = None)(body: Html)(implicit context: gitbucket.core.controller.Context)
@import gitbucket.core.plugin.PluginRegistry
@import gitbucket.core.view.helpers
@hasSidebar = @{body.toString.contains("main-sidebar")}
<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>@title</title>
    <meta property="og:title" content="@title" />
    <meta property="og:type" content="object" />
    <meta property="og:url" content="@context.request.getRequestURL" />
    @if(repository.isEmpty){
      <meta property="og:image" content="@context.baseUrl/assets/common/images/gitbucket_ogp.png" />
    }
    @repository.map{ r =>
      <meta property="og:image" content="@context.baseUrl/@r.owner/_avatar" />
      @r.repository.description.map{ desc =>
        <meta property="og:description" content="@desc" />
      }
    }
    <link rel="icon" href="@helpers.assets("/common/images/gitbucket.png")" type="image/vnd.microsoft.icon" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/fontawesome-free/css/all.min.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/icheck-bootstrap/icheck-bootstrap.min.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/jqvmap/jqvmap.min.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/dist/css/adminlte.min.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/overlayScrollbars/css/OverlayScrollbars.min.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/daterangepicker/daterangepicker.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/summernote/summernote-bs4.css")"
    <link href="@helpers.assets(s"/vendors/google-fonts/css/source-sans-pro.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/octicons-4.4.0/octicons.min.css")" rel="stylesheet">

    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/jquery/jquery.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/bootstrap/js/bootstrap.bundle.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/chart.js/Chart.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/sparklines/sparkline.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/jqvmap/jquery.vmap.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/jqvmap/maps/jquery.vmap.usa.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/jquery-knob/jquery.knob.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/moment/moment.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/daterangepicker/daterangepicker.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/summernote/summernote-bs4.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js")"></script>
    <script src="@helpers.assets(s"/vendors/AdminLTE-3.0.2/dist/js/adminlte.min.js")"></script>


    <!--<link href="@helpers.assets("/vendors/google-fonts/css/source-sans-pro.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/bootstrap-3.4.1/css/bootstrap.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/octicons-4.4.0/octicons.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/bootstrap-datetimepicker-4.17.44/css/bootstrap-datetimepicker.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/colorpicker/css/bootstrap-colorpicker.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/google-code-prettify/prettify.css")" type="text/css" rel="stylesheet"/>
    <link href="@helpers.assets("/vendors/facebox/facebox.css")" rel="stylesheet"/>
    <link href="@helpers.assets("/vendors/AdminLTE-3.0.2/css/adminlte.min.css")" rel="stylesheet">
    <link href="@helpers.assets(s"/vendors/AdminLTE-3.0.2/css/skins/${context.settings.skinName}.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/fontawesome-free-5.12.0-web/css/fontawesome.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/jquery-ui/jquery-ui.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/jquery-ui/jquery-ui.structure.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/vendors/jquery-ui/jquery-ui.theme.min.css")" rel="stylesheet">
    <link href="@helpers.assets("/common/css/gitbucket.css")" rel="stylesheet">
    <script src="@helpers.assets("/vendors/jquery/jquery-3.4.1.min.js")"></script>
    <script src="@helpers.assets("/vendors/jquery-ui/jquery-ui.min.js")"></script>
    <script src="@helpers.assets("/vendors/dropzone/dropzone.min.js")"></script>
    <script src="@helpers.assets("/common/js/validation.js")"></script>
    <script src="@helpers.assets("/common/js/gitbucket.js")"></script>
    <script src="@helpers.assets("/vendors/bootstrap-3.4.1/js/bootstrap.min.js")"></script>
    <script src="@helpers.assets("/vendors/bootstrap3-typeahead/bootstrap3-typeahead.min.js")"></script>
    <script src="@helpers.assets("/vendors/bootstrap-datetimepicker-4.17.44/js/moment.min.js")"></script>
    <script src="@helpers.assets("/vendors/bootstrap-datetimepicker-4.17.44/js/bootstrap-datetimepicker.min.js")"></script>
    <script src="@helpers.assets("/vendors/colorpicker/js/bootstrap-colorpicker.min.js")"></script>
    <script src="@helpers.assets("/vendors/google-code-prettify/prettify.js")"></script>
    <script src="@helpers.assets("/vendors/elastic/jquery.elastic.source.js")"></script>
    <script src="@helpers.assets("/vendors/facebox/facebox.js")"></script>
    <script src="@helpers.assets("/vendors/jquery-hotkeys/jquery.hotkeys.js")"></script>
    <script src="@helpers.assets("/vendors/jquery-textcomplete-1.8.4/jquery.textcomplete.min.js")"></script>-->

    @repository.map { repository =>
      <meta name="go-import" content="@context.baseUrl.replaceFirst("^https?://", "")/@repository.owner/@repository.name git @repository.httpUrl" />
    }
  </head>
  <body class="hold-transition @context.settings.skinName text-sm layout-fixed @if(hasSidebar){sidebar-mini}else{layout-top-nav} @if(context.sidebarCollapse){sidebar-collapse}">
    <div class="wrapper">
      <nav class="main-header navbar navbar-expand navbar-white navbar-light">
        @if(!hasSidebar){
        @gitbucket.core.helper.html.logo()
        }
        <!-- Sidebar toggle button-->
        <ul class="navbar-nav">
          @if(body.toString.contains("main-sidebar")){
          <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
          </li>}
        </ul>
        <!-- Search -->
        <form id="search" action="@context.path/search" method="GET" class="form-inline ml-3" role="search">
          <div class="input-group input-group-sm">
            <input type="text" name="query" id="navbar-search-input" class="form-control form-control-sm form-control-navbar" placeholder="Search repository"/>
            <div class="input-group-append">
              <button class="btn btn-sm btn-navbar" type="submit">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
        </form>
        <!-- buttons -->
        <ul class="navbar-nav">
          @if(context.loginAccount.isDefined){
          <li class="nav-item d-none d-md-inline-block"><a href="@context.path/dashboard/pulls" class="nav-link">Pull requests</a></li>
          <li class="nav-item d-none d-md-inline-block"><a href="@context.path/dashboard/issues" class="nav-link">Issues</a></li>
          }
          @gitbucket.core.plugin.PluginRegistry().getGlobalMenus.map { menu =>
          @menu(context).map { link =>
          <li class="nav-item d-none d-md-inline-block"><a href="@context.path/@link.path" class="nav-link">@link.label</a></li>
          }}
        </ul>
        <!-- right navbar -->
        <ul class="navbar-nav ml-auto">
          @if(context.loginAccount.isDefined){
          <li class="nav-item dropdown">
            <a class="nav-link" href="#" id="navbarDropdown" data-toggle="dropdown">
              <i class="octicon octicon-plus"></i>
            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <a class="dropdown-item" href="@context.path/new">New repository</a>
              <a class="dropdown-item" href="@context.path/groups/new">New group</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" title="Signed is as @context.loginAccount.get.userName">
              @helpers.avatar(context.loginAccount.get.userName, 16)
            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <a class="dropdown-item" href="@helpers.url(context.loginAccount.get.userName)">Your profile</a>
              <a class="dropdown-item" href="@helpers.url(context.loginAccount.get.userName)/_edit">Account settings</a>
              @if(context.loginAccount.get.isAdmin){
              <a class="dropdown-item" href="@context.path/admin/users">System administration</a>
              }
              <a class="dropdown-item" href="@context.path/signout">Sign out</a>
            </div>
          } else {
          <li class="nav-item">
            <a class="dropdown-item" href="@context.path/signin?redirect=@helpers.urlEncode(context.currentPath)" id="signin">Sign in</a>
          </li>
          }
        </ul>
      </nav>
      @body
    <script>
      $(function(){
        @*
        $('#search').submit(function(){
          return $.trim($(this).find('input[name=query]').val()) != '';
        });
        *@
        @if(body.toString.contains("main-sidebar")){
          $(".sidebar-toggle").on('click', function(e){
            $.post('@context.path/sidebar-collapse', { collapse: !$('body').hasClass('sidebar-collapse') });
          });
        }
      });
    </script>
    @PluginRegistry().getJavaScript(context.request.getRequestURI).map { script =>
      <script>
        @Html(script)
      </script>
    }
    </div>
  </body>
</html>
