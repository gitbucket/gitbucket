@(repository: gitbucket.core.service.RepositoryService.RepositoryInfo, deployKeys: List[gitbucket.core.model.DeployKey])(implicit context: gitbucket.core.controller.Context)
@import gitbucket.core.ssh.SshUtil
@import gitbucket.core.view.helpers
@gitbucket.core.html.main("Deploy keys", Some(repository)){
  @gitbucket.core.html.menu("settings", repository){
    @gitbucket.core.settings.html.menu("deploykeys", repository){
    <form method="POST" action="@helpers.url(repository)/settings/deploykey" validate="true" autocomplete="off">
      <div class="card-body">
        <h3>Deploy keys</h3>
        <div>
          @if(deployKeys.isEmpty){
            No keys
          }
          @deployKeys.zipWithIndex.map { case (key, i) =>
          <hr>
          <strong style="line-height: 30px;">@key.title</strong> (@SshUtil.fingerPrint(key.publicKey).getOrElse("Key is invalid."))
          @if(key.allowWrite){
            <label class="badge badge-warning">Write access</label>
          }
          <a href="@helpers.url(repository)/settings/deploykey/delete/@key.deployKeyId" class="btn btn-sm btn-danger float-right">Delete</a>
          }
        </div>
        <h3 class="mt-4">Add a deploy key</h3>
        <div>
          <fieldset class="form-group">
            <label for="title">Title</label>
            <div><span id="error-title" class="error"></span></div>
            <input type="text" name="title" id="title" class="form-control form-control-sm"/>
          </fieldset>
          <fieldset class="form-group">
            <label for="publicKey" class="strong">Key</label>
            <div><span id="error-publicKey" class="error"></span></div>
            <textarea name="publicKey" id="publicKey" class="form-control" style="height: 200px;"></textarea>
          </fieldset>
          <fieldset class="form-group">
            <label>
              <input type="checkbox" name="allowWrite"> Allow write access
            </label>
          </fieldset>
        </div>
      </div>
      <div class="card-footer">
        <div class="float-right">
          <input type="submit" class="btn btn-success" value="Add"/>
        </div>
      </div>
    </form>
    }
  }
}
